{"ast":null,"code":"import { cloneDeep } from 'lodash-es';\nimport { labels as labelsData, notes as notesData } from 'app/mock-api/apps/notes/data';\nimport { FuseMockApiUtils } from '@fuse/lib/mock-api';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@fuse/lib/mock-api/mock-api.service\";\nexport let NotesMockApi = /*#__PURE__*/(() => {\n  class NotesMockApi {\n    /**\r\n     * Constructor\r\n     */\n    constructor(_fuseMockApiService) {\n      this._fuseMockApiService = _fuseMockApiService;\n      this._labels = labelsData;\n      this._notes = notesData;\n      // Register Mock API handlers\n      this.registerHandlers();\n    }\n    // -----------------------------------------------------------------------------------------------------\n    // @ Public methods\n    // -----------------------------------------------------------------------------------------------------\n    /**\r\n     * Register Mock API handlers\r\n     */\n    registerHandlers() {\n      // -----------------------------------------------------------------------------------------------------\n      // @ Labels - GET\n      // -----------------------------------------------------------------------------------------------------\n      this._fuseMockApiService.onGet('api/apps/notes/labels').reply(() => [200, cloneDeep(this._labels)]);\n      // -----------------------------------------------------------------------------------------------------\n      // @ Labels - POST\n      // -----------------------------------------------------------------------------------------------------\n      this._fuseMockApiService.onPost('api/apps/notes/labels').reply(({\n        request\n      }) => {\n        // Create a new label\n        const label = {\n          id: FuseMockApiUtils.guid(),\n          title: request.body.title\n        };\n        // Update the labels\n        this._labels.push(label);\n        return [200, cloneDeep(this._labels)];\n      });\n      // -----------------------------------------------------------------------------------------------------\n      // @ Labels - PATCH\n      // -----------------------------------------------------------------------------------------------------\n      this._fuseMockApiService.onPatch('api/apps/notes/labels').reply(({\n        request\n      }) => {\n        // Get label\n        const updatedLabel = request.body.label;\n        // Update the label\n        this._labels = this._labels.map(label => {\n          if (label.id === updatedLabel.id) {\n            return Object.assign(Object.assign({}, label), {\n              title: updatedLabel.title\n            });\n          }\n          return label;\n        });\n        return [200, cloneDeep(this._labels)];\n      });\n      // -----------------------------------------------------------------------------------------------------\n      // @ Labels - DELETE\n      // -----------------------------------------------------------------------------------------------------\n      this._fuseMockApiService.onDelete('api/apps/notes/labels').reply(({\n        request\n      }) => {\n        // Get label id\n        const id = request.params.get('id');\n        // Delete the label\n        this._labels = this._labels.filter(label => label.id !== id);\n        // Go through notes and delete the label\n        this._notes = this._notes.map(note => Object.assign(Object.assign({}, note), {\n          labels: note.labels.filter(item => item !== id)\n        }));\n        return [200, cloneDeep(this._labels)];\n      });\n      // -----------------------------------------------------------------------------------------------------\n      // @ Note Tasks - POST\n      // -----------------------------------------------------------------------------------------------------\n      this._fuseMockApiService.onPost('api/apps/notes/tasks').reply(({\n        request\n      }) => {\n        // Get note and task\n        let updatedNote = request.body.note;\n        const task = request.body.task;\n        // Update the note\n        this._notes = this._notes.map(note => {\n          if (note.id === updatedNote.id) {\n            // Update the tasks\n            if (!note.tasks) {\n              note.tasks = [];\n            }\n            note.tasks.push({\n              id: FuseMockApiUtils.guid(),\n              content: task,\n              completed: false\n            });\n            // Update the updatedNote with the new task\n            updatedNote = cloneDeep(note);\n            return Object.assign({}, note);\n          }\n          return note;\n        });\n        return [200, updatedNote];\n      });\n      // -----------------------------------------------------------------------------------------------------\n      // @ Notes - GET\n      // -----------------------------------------------------------------------------------------------------\n      this._fuseMockApiService.onGet('api/apps/notes/all').reply(() => {\n        // Clone the labels and notes\n        const labels = cloneDeep(this._labels);\n        let notes = cloneDeep(this._notes);\n        // Attach the labels to the notes\n        notes = notes.map(note => Object.assign(Object.assign({}, note), {\n          labels: note.labels.map(labelId => labels.find(label => label.id === labelId))\n        }));\n        return [200, notes];\n      });\n      // -----------------------------------------------------------------------------------------------------\n      // @ Notes - POST\n      // -----------------------------------------------------------------------------------------------------\n      this._fuseMockApiService.onPost('api/apps/notes').reply(({\n        request\n      }) => {\n        // Get note\n        const note = request.body.note;\n        // Add an id\n        note.id = FuseMockApiUtils.guid();\n        // Push the note\n        this._notes.push(note);\n        return [200, note];\n      });\n      // -----------------------------------------------------------------------------------------------------\n      // @ Notes - PATCH\n      // -----------------------------------------------------------------------------------------------------\n      this._fuseMockApiService.onPatch('api/apps/notes').reply(({\n        request\n      }) => {\n        // Get note\n        const updatedNote = request.body.updatedNote;\n        // Update the note\n        this._notes = this._notes.map(note => {\n          if (note.id === updatedNote.id) {\n            return Object.assign({}, updatedNote);\n          }\n          return note;\n        });\n        return [200, updatedNote];\n      });\n      // -----------------------------------------------------------------------------------------------------\n      // @ Notes - DELETE\n      // -----------------------------------------------------------------------------------------------------\n      this._fuseMockApiService.onDelete('api/apps/notes').reply(({\n        request\n      }) => {\n        // Get the id\n        const id = request.params.get('id');\n        // Find the note and delete it\n        this._notes.forEach((item, index) => {\n          if (item.id === id) {\n            this._notes.splice(index, 1);\n          }\n        });\n        // Return the response\n        return [200, true];\n      });\n    }\n  }\n  NotesMockApi.ɵfac = function NotesMockApi_Factory(t) {\n    return new (t || NotesMockApi)(i0.ɵɵinject(i1.FuseMockApiService));\n  };\n  NotesMockApi.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: NotesMockApi,\n    factory: NotesMockApi.ɵfac,\n    providedIn: 'root'\n  });\n  return NotesMockApi;\n})();","map":null,"metadata":{},"sourceType":"module"}